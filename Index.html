<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css"> @import url(https://themes.googleusercontent.com/fonts/css?kit=kbffV7V9BIH3Ot2AQ2LQRA);</style></head><body class="doc-content" style="background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt"><p style="padding:0;margin:0;color:#000000;font-size:11pt;font-family:&quot;Arial&quot;;line-height:1.0;text-align:left"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:&quot;Courier&quot;;font-style:normal">&lt;!DOCTYPE html&gt;<br>&lt;html lang=&quot;pt-BR&quot;&gt;<br>&lt;head&gt;<br> &nbsp; &nbsp;&lt;meta charset=&quot;UTF-8&quot;&gt;<br> &nbsp; &nbsp;&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;<br> &nbsp; &nbsp;&lt;title&gt;Cashless v6.1 Corrigido&lt;/title&gt;<br> &nbsp; &nbsp;&lt;script src=&quot;https://cdn.tailwindcss.com&quot;&gt;&lt;/script&gt;<br> &nbsp; &nbsp;&lt;link rel=&quot;preconnect&quot; href=&quot;https://fonts.googleapis.com&quot;&gt;<br> &nbsp; &nbsp;&lt;link rel=&quot;preconnect&quot; href=&quot;https://fonts.gstatic.com&quot; crossorigin&gt;<br> &nbsp; &nbsp;&lt;link href=&quot;https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&amp;display=swap&quot; rel=&quot;stylesheet&quot;&gt;<br> &nbsp; &nbsp;&lt;script src=&quot;https://unpkg.com/html5-qrcode@2.3.8/html5-qrcode.min.js&quot;&gt;&lt;/script&gt;<br> &nbsp; &nbsp;&lt;script src=&quot;https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js&quot;&gt;&lt;/script&gt;<br><br> &nbsp; &nbsp;&lt;style&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;:root {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;--bg-start: #1a202c;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;--bg-end: #2d3748;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;--card-bg: rgba(255, 255, 255, 0.05);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;--card-border: rgba(255, 255, 255, 0.1);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;--primary-text: #ffffff;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;--secondary-text: #a0aec0;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;--brand-orange: #f7971e;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;--brand-yellow: #ffd200;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;--brand-gradient: linear-gradient(135deg, var(--brand-orange) 0%, var(--brand-yellow) 100%);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;--accent-green: #38a169;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;--brand-purple: #805ad5;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;--brand-teal: #319795;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;--brand-dark: #1a202c;<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br><br> &nbsp; &nbsp; &nbsp; &nbsp;body {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;font-family: &#39;Inter&#39;, sans-serif;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;background-color: var(--bg-start);<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br><br> &nbsp; &nbsp; &nbsp; &nbsp;#app-container {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;background: linear-gradient(180deg, var(--bg-start) 0%, var(--bg-end) 100%);<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br><br> &nbsp; &nbsp; &nbsp; &nbsp;.screen {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;display: none;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;animation: fadeIn 0.5s ease-in-out;<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br><br> &nbsp; &nbsp; &nbsp; &nbsp;.screen.active {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;display: flex;<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br><br> &nbsp; &nbsp; &nbsp; &nbsp;.modal {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;display: none;<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br><br> &nbsp; &nbsp; &nbsp; &nbsp;.modal.active {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;display: flex;<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br><br> &nbsp; &nbsp; &nbsp; &nbsp;@keyframes fadeIn {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;from {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;opacity: 0;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;transform: translateY(10px);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;to {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;opacity: 1;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;transform: translateY(0);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br><br> &nbsp; &nbsp; &nbsp; &nbsp;.glass-card {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;background: var(--card-bg);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;backdrop-filter: blur(10px);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-webkit-backdrop-filter: blur(10px);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;border: 1px solid var(--card-border);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br><br> &nbsp; &nbsp; &nbsp; &nbsp;.btn {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;transition: all 0.2s ease-in-out;<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br><br> &nbsp; &nbsp; &nbsp; &nbsp;.btn:hover {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;transform: scale(1.03);<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br><br> &nbsp; &nbsp; &nbsp; &nbsp;.btn-primary {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;background: var(--brand-gradient);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;color: var(--brand-dark);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;box-shadow: 0 4px 20px 0 rgba(255, 153, 0, 0.3);<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;.icon {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;stroke-width: 2;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;width: 24px;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;height: 24px;<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp;&lt;/style&gt;<br>&lt;/head&gt;<br>&lt;body class=&quot;antialiased&quot;&gt;<br><br> &nbsp; &nbsp;&lt;div id=&quot;app-container&quot; class=&quot;max-w-md mx-auto min-h-screen flex flex-col&quot;&gt;<br><br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;!-- Telas de Estado --&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;div id=&quot;loading-screen&quot; class=&quot;screen active flex-col items-center justify-center p-6&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;svg class=&quot;animate-spin h-10 w-10 text-[var(--brand-orange)]&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; fill=&quot;none&quot; viewBox=&quot;0 0 24 24&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;circle class=&quot;opacity-25&quot; cx=&quot;12&quot; cy=&quot;12&quot; r=&quot;10&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;4&quot;&gt;&lt;/circle&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;path class=&quot;opacity-75&quot; fill=&quot;currentColor&quot; d=&quot;M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z&quot;&gt;&lt;/path&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/svg&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;h2 class=&quot;text-xl font-semibold mt-4 text-white&quot;&gt;Iniciando...&lt;/h2&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br><br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;div id=&quot;data-loading-screen&quot; class=&quot;screen flex-col items-center justify-center p-6&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;svg class=&quot;animate-spin h-10 w-10 text-[var(--brand-orange)]&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; fill=&quot;none&quot; viewBox=&quot;0 0 24 24&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;circle class=&quot;opacity-25&quot; cx=&quot;12&quot; cy=&quot;12&quot; r=&quot;10&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;4&quot;&gt;&lt;/circle&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;path class=&quot;opacity-75&quot; fill=&quot;currentColor&quot; d=&quot;M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z&quot;&gt;&lt;/path&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/svg&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;h2 class=&quot;text-xl font-semibold mt-4 text-white&quot;&gt;Carregando seus dados...&lt;/h2&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br><br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;!-- Telas Principais --&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;div id=&quot;auth-screen&quot; class=&quot;screen flex-col justify-center p-8&quot;&gt;&lt;/div&gt;<br><br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;div id=&quot;role-selection-screen&quot; class=&quot;screen flex-col items-center justify-center p-8 space-y-8&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;h1 class=&quot;text-3xl font-extrabold text-center text-white&quot;&gt;Defina seu Perfil&lt;/h1&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;p class=&quot;text-center text-gray-400&quot;&gt;Esta escolha &eacute; permanente e definir&aacute; como voc&ecirc; usar&aacute; o aplicativo.&lt;/p&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=&quot;w-full space-y-6&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button id=&quot;select-role-client&quot; class=&quot;w-full text-white font-bold p-6 rounded-2xl text-2xl btn glass-card flex flex-col items-center&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;svg class=&quot;icon mb-2&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; viewBox=&quot;0 0 24 24&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot;&gt;&lt;path stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot; d=&quot;M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Sou Cliente<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button id=&quot;select-role-vendor&quot; class=&quot;w-full text-white font-bold p-6 rounded-2xl text-2xl btn glass-card flex flex-col items-center&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;svg class=&quot;icon mb-2&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; viewBox=&quot;0 0 24 24&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot;&gt;&lt;path stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot; d=&quot;M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Sou Vendedor<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br><br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;!-- MODO CLIENTE --&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;div id=&quot;client-dashboard-screen&quot; class=&quot;screen flex-col text-white&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;header class=&quot;p-6 flex justify-between items-center&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;h1 class=&quot;text-2xl font-bold&quot;&gt;Minha Carteira&lt;/h1&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button id=&quot;client-logout-button&quot; class=&quot;glass-card p-2 rounded-full&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;svg class=&quot;w-6 h-6&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; viewBox=&quot;0 0 24 24&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot;&gt;&lt;path stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot; d=&quot;M17 16l-4-4m0 0l-4 4m4-4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1&quot;&gt;&lt;/path&gt;&lt;/svg&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/header&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;main class=&quot;p-6 space-y-6 flex-grow&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=&quot;p-6 rounded-2xl text-center glass-card&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;span class=&quot;text-sm uppercase font-semibold text-gray-400&quot;&gt;Saldo Atual&lt;/span&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;p id=&quot;client-balance-display&quot; class=&quot;text-5xl font-extrabold&quot;&gt;R$ 0,00&lt;/p&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=&quot;grid grid-cols-2 gap-4&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button id=&quot;redeem-code-button&quot; class=&quot;glass-card p-4 rounded-2xl flex flex-col items-center justify-center space-y-2 btn&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;svg class=&quot;icon text-green-400&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; viewBox=&quot;0 0 24 24&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot;&gt;&lt;path stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot; d=&quot;M12 8v13m0-13V6a2 2 0 112 2h-2zm0 0V5.5A2.5 2.5 0 109.5 8H12zm-7 4h14M5 12a2 2 0 110-4h14a2 2 0 110 4M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7&quot;&gt;&lt;/path&gt;&lt;/svg&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;span class=&quot;font-semibold text-sm&quot;&gt;Recarregar&lt;/span&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button id=&quot;pay-nfc-button&quot; class=&quot;glass-card p-4 rounded-2xl flex flex-col items-center justify-center space-y-2 btn&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;svg class=&quot;icon text-blue-400&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; viewBox=&quot;0 0 24 24&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot;&gt;&lt;path stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot; d=&quot;M8.684 13.342C8.886 12.938 9 12.482 9 12s-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;span class=&quot;font-semibold text-sm&quot;&gt;Pagar NFC&lt;/span&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button id=&quot;show-my-code-button&quot; class=&quot;glass-card p-4 rounded-2xl flex flex-col items-center justify-center space-y-2 btn&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;svg class=&quot;icon text-purple-400&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; viewBox=&quot;0 0 24 24&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot;&gt;&lt;path stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot; d=&quot;M12 4v1m6 11h2m-6.586 4.414l.707.707M4 12h-1m17.586 4.414l-.707.707M6.414 6.414l.707-.707m12.172 0l-.707-.707M12 20.5v.5m-6.414-1.414l-.707.707M17.586 6.414l.707-.707&quot;&gt;&lt;/path&gt;&lt;/svg&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;span class=&quot;font-semibold text-sm&quot;&gt;Meu C&oacute;digo&lt;/span&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button id=&quot;show-history-button&quot; class=&quot;glass-card p-4 rounded-2xl flex flex-col items-center justify-center space-y-2 btn&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;svg class=&quot;icon text-gray-400&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; viewBox=&quot;0 0 24 24&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot;&gt;&lt;path stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot; d=&quot;M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;span class=&quot;font-semibold text-sm&quot;&gt;Hist&oacute;rico&lt;/span&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/main&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;footer class=&quot;p-4&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button id=&quot;client-back-to-mode-selection&quot; class=&quot;w-full text-center text-sm text-gray-400 hover:text-white&quot;&gt;N&atilde;o &eacute; seu perfil? Trocar&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/footer&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br><br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;!-- TELA DE RESGATE DE C&Oacute;DIGO --&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;div id=&quot;redeem-code-screen&quot; class=&quot;screen flex-col p-6 space-y-6 justify-center&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;h2 class=&quot;text-3xl font-bold text-center text-white&quot;&gt;Resgatar C&oacute;digo&lt;/h2&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;form id=&quot;redeem-code-form&quot; class=&quot;w-full space-y-4&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;input type=&quot;text&quot; id=&quot;recharge-code-input&quot; placeholder=&quot;Digite o c&oacute;digo de recarga&quot; class=&quot;w-full text-center text-lg px-4 py-4 rounded-2xl bg-white/10 text-white border-2 border-[var(--card-border)] focus:outline-none focus:ring-2 ring-[var(--brand-orange)]&quot; required&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button type=&quot;submit&quot; class=&quot;w-full font-bold py-4 rounded-2xl text-xl btn btn-primary&quot;&gt;Resgatar&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/form&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button id=&quot;redeem-code-back-button&quot; class=&quot;w-full text-center text-gray-400 hover:text-white&quot;&gt;Voltar&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br><br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;!-- MODO VENDEDOR --&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;div id=&quot;vendor-dashboard-screen&quot; class=&quot;screen flex-col h-screen&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;header class=&quot;p-6 flex justify-between items-center&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;h1 class=&quot;text-2xl font-bold text-white&quot;&gt;Ponto de Venda&lt;/h1&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button id=&quot;vendor-logout-button&quot; class=&quot;glass-card p-2 rounded-full text-white&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;svg class=&quot;w-6 h-6&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; viewBox=&quot;0 0 24 24&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot;&gt;&lt;path stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot; d=&quot;M17 16l-4-4m0 0l-4 4m4-4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1&quot;&gt;&lt;/path&gt;&lt;/svg&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/header&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=&quot;px-6 pb-4&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=&quot;glass-card p-4 rounded-2xl flex justify-between items-center&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;span class=&quot;text-sm uppercase font-semibold text-gray-400&quot;&gt;Meu Saldo&lt;/span&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;p id=&quot;vendor-balance-display&quot; class=&quot;text-2xl font-extrabold text-green-400&quot;&gt;R$ 0,00&lt;/p&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=&quot;px-6 pb-4 grid grid-cols-3 gap-4&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button id=&quot;open-recharge-modal-button&quot; class=&quot;w-full text-white text-xs font-bold py-3 rounded-2xl glass-card btn&quot;&gt;Recarregar&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button id=&quot;open-card-manager-button&quot; class=&quot;w-full text-white text-xs font-bold py-3 rounded-2xl glass-card btn&quot;&gt;Ger. Cart&otilde;es&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button id=&quot;open-code-generator-button&quot; class=&quot;w-full text-white text-xs font-bold py-3 rounded-2xl glass-card btn&quot;&gt;Gerar C&oacute;digo&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;main class=&quot;flex-grow flex flex-col md:flex-row overflow-hidden&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=&quot;w-full md:w-1/2 p-3 overflow-y-auto&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=&quot;flex justify-between items-center mb-3 px-3&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;h3 class=&quot;font-bold text-lg text-white&quot;&gt;Produtos&lt;/h3&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button id=&quot;manage-products-button&quot; class=&quot;glass-card text-white text-sm font-semibold py-1 px-3 rounded-lg&quot;&gt;Gerenciar&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div id=&quot;vendor-product-list&quot; class=&quot;grid grid-cols-2 gap-4 p-3&quot;&gt;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=&quot;w-full md:w-1/2 p-3 flex flex-col bg-black/20 rounded-t-3xl&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;h3 class=&quot;font-bold text-lg mb-3 px-3 text-white&quot;&gt;Carrinho&lt;/h3&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div id=&quot;cart-items&quot; class=&quot;flex-grow space-y-2 overflow-y-auto px-3&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;p class=&quot;text-gray-400 text-center mt-8&quot;&gt;Carrinho vazio.&lt;/p&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=&quot;border-t border-white/10 pt-3 mt-3 px-3&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=&quot;flex justify-between font-bold text-xl text-white&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;span&gt;Total&lt;/span&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;span id=&quot;cart-total&quot;&gt;R$ 0,00&lt;/span&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button id=&quot;checkout-button&quot; class=&quot;w-full font-bold py-4 rounded-2xl mt-3 btn btn-primary disabled:opacity-50&quot; disabled&gt;Cobrar&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/main&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;footer class=&quot;p-4&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button id=&quot;vendor-back-to-mode-selection&quot; class=&quot;w-full text-center text-sm text-gray-400 hover:text-white&quot;&gt;N&atilde;o &eacute; seu perfil? Trocar&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/footer&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br><br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;!-- TELA DE PAGAMENTO DO VENDEDOR --&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;div id=&quot;vendor-payment-screen&quot; class=&quot;screen flex-col justify-center p-6 text-white&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;h2 class=&quot;text-2xl font-light text-center&quot;&gt;Valor a Pagar&lt;/h2&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;p id=&quot;payment-total-display&quot; class=&quot;text-6xl font-extrabold text-center my-6 text-[var(--brand-orange)]&quot;&gt;R$ 0,00&lt;/p&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=&quot;space-y-4&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button id=&quot;receive-via-nfc-button&quot; class=&quot;w-full p-4 rounded-lg font-semibold text-lg btn glass-card&quot;&gt;Ler Cart&atilde;o / Celular NFC&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button id=&quot;receive-via-qr-button&quot; type=&quot;button&quot; class=&quot;w-full p-4 rounded-lg font-semibold text-lg btn glass-card&quot;&gt;Ler QR Code (C&acirc;mera)&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button id=&quot;import-qr-button&quot; type=&quot;button&quot; class=&quot;w-full p-4 rounded-lg font-semibold text-lg btn glass-card&quot;&gt;Importar QR Code (Galeria)&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;input type=&quot;file&quot; id=&quot;qr-file-input&quot; class=&quot;hidden&quot; accept=&quot;image/*&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;form id=&quot;receive-via-code-form&quot; class=&quot;flex space-x-2&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;input type=&quot;number&quot; id=&quot;receive-code-input&quot; placeholder=&quot;C&oacute;digo do Cliente&quot; class=&quot;w-full px-3 py-2 rounded-lg bg-gray-700 text-white border-gray-600 border-2 focus:outline-none focus:ring-2 ring-[var(--brand-orange)]&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button type=&quot;submit&quot; class=&quot;bg-gray-200 text-gray-800 font-bold py-2 px-4 rounded-lg btn&quot;&gt;OK&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/form&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button id=&quot;cancel-payment-button&quot; class=&quot;mt-8 text-center text-gray-400 hover:text-white&quot;&gt;Cancelar&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp;&lt;/div&gt;<br><br> &nbsp; &nbsp;&lt;!-- Modals --&gt;<br> &nbsp; &nbsp;&lt;div id=&quot;generic-modal&quot; class=&quot;modal fixed inset-0 bg-black/50 backdrop-blur-sm items-center justify-center p-4 z-50&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=&quot;glass-card text-white rounded-2xl shadow-xl p-6 max-w-sm w-full&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div id=&quot;generic-modal-content&quot;&gt;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button id=&quot;generic-modal-close-button&quot; class=&quot;mt-6 bg-white/10 text-white font-bold py-2 px-6 rounded-lg hover:bg-white/20 w-full&quot;&gt;Fechar&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp;&lt;/div&gt;<br><br> &nbsp; &nbsp;&lt;div id=&quot;history-modal&quot; class=&quot;modal fixed inset-0 bg-black/50 backdrop-blur-sm items-center justify-center p-4 z-50&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=&quot;glass-card text-white rounded-2xl shadow-xl p-6 max-w-md w-full h-4/5 flex flex-col&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;h2 class=&quot;text-2xl font-bold mb-4&quot;&gt;Hist&oacute;rico de Compras&lt;/h2&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div id=&quot;history-list&quot; class=&quot;flex-grow overflow-y-auto border-t border-white/10 pt-3&quot;&gt;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button id=&quot;close-history-modal-button&quot; class=&quot;mt-6 bg-white/10 text-white font-bold py-2 px-6 rounded-lg hover:bg-white/20 w-full&quot;&gt;Fechar&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp;&lt;/div&gt;<br><br> &nbsp; &nbsp;&lt;div id=&quot;manage-products-modal&quot; class=&quot;modal fixed inset-0 bg-black/50 backdrop-blur-sm items-center justify-center p-4 z-50&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=&quot;glass-card text-white rounded-2xl shadow-xl p-6 max-w-sm w-full h-4/5 flex flex-col&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;h2 class=&quot;text-2xl font-bold mb-4&quot;&gt;Gerenciar Produtos&lt;/h2&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;form id=&quot;add-product-form&quot; class=&quot;space-y-3 mb-4&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;input type=&quot;text&quot; id=&quot;product-name&quot; placeholder=&quot;Nome do produto&quot; class=&quot;w-full px-3 py-2 border-2 border-gray-600 bg-gray-700 text-white rounded-lg&quot; required&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;input type=&quot;number&quot; id=&quot;product-price&quot; placeholder=&quot;Pre&ccedil;o (ex: 12.50)&quot; step=&quot;0.01&quot; class=&quot;w-full px-3 py-2 border-2 border-gray-600 bg-gray-700 text-white rounded-lg&quot; required&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button type=&quot;submit&quot; class=&quot;w-full font-bold py-2 rounded-lg btn btn-primary&quot;&gt;Adicionar Produto&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/form&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=&quot;flex-grow overflow-y-auto border-t border-white/10 pt-3&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;h3 class=&quot;font-semibold mb-2&quot;&gt;Lista de Produtos&lt;/h3&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div id=&quot;products-management-list&quot; class=&quot;space-y-2&quot;&gt;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button id=&quot;close-products-modal-button&quot; class=&quot;mt-6 bg-white/10 text-white font-bold py-2 px-6 rounded-lg hover:bg-white/20 w-full&quot;&gt;Fechar&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp;&lt;/div&gt;<br><br> &nbsp; &nbsp;&lt;div id=&quot;qr-reader-modal&quot; class=&quot;modal fixed inset-0 bg-black z-50 flex-col items-center justify-center&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;p class=&quot;text-white text-lg mb-4&quot;&gt;Aponte a c&acirc;mera para o QR Code do cliente&lt;/p&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;div id=&quot;qr-reader&quot; class=&quot;w-full max-w-sm border-4 border-white rounded-lg overflow-hidden&quot;&gt;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;button id=&quot;qr-reader-close&quot; class=&quot;mt-6 bg-red-500 text-white font-bold py-2 px-8 rounded-lg&quot;&gt;Cancelar&lt;/button&gt;<br> &nbsp; &nbsp;&lt;/div&gt;<br><br> &nbsp; &nbsp;&lt;div id=&quot;card-manager-modal&quot; class=&quot;modal fixed inset-0 bg-black/50 backdrop-blur-sm items-center justify-center p-4 z-50&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=&quot;glass-card text-white rounded-2xl shadow-xl p-6 max-w-md w-full h-auto flex flex-col&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;h2 class=&quot;text-2xl font-bold mb-4 text-[var(--brand-purple)]&quot;&gt;Gerenciar Cart&otilde;es NFC&lt;/h2&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=&quot;space-y-4&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=&quot;p-3 border border-white/10 rounded-lg&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;h3 class=&quot;font-semibold mb-2&quot;&gt;1. Ler Cart&atilde;o NFC&lt;/h3&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button id=&quot;read-card-button&quot; class=&quot;w-full bg-blue-500 text-white p-3 rounded-lg&quot;&gt;Ler ID do Cart&atilde;o&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;p class=&quot;mt-2&quot;&gt;ID LIDO: &lt;strong id=&quot;scanned-card-id&quot; class=&quot;text-blue-400&quot;&gt;Nenhum&lt;/strong&gt;&lt;/p&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=&quot;p-3 border border-white/10 rounded-lg&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;h3 class=&quot;font-semibold mb-2&quot;&gt;2. Buscar Usu&aacute;rio (para vincular)&lt;/h3&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;form id=&quot;search-user-for-card-form&quot; class=&quot;flex space-x-2&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;input type=&quot;email&quot; id=&quot;search-user-for-card-email&quot; placeholder=&quot;E-mail do usu&aacute;rio&quot; class=&quot;w-full px-3 py-2 bg-white/10 border-2 border-white/20 rounded-lg&quot; required&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button type=&quot;submit&quot; class=&quot;bg-gray-600 text-white font-bold p-3 rounded-lg&quot;&gt;Buscar&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/form&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div id=&quot;found-user-for-card-info&quot; class=&quot;mt-2 text-sm&quot;&gt;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=&quot;p-3 border-t border-white/10&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;h3 class=&quot;font-semibold mb-2&quot;&gt;3. Vincular&lt;/h3&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button id=&quot;link-card-button&quot; class=&quot;w-full text-white font-bold p-3 rounded-lg btn bg-[var(--brand-purple)] disabled:opacity-50&quot; disabled&gt;Vincular Cart&atilde;o ao Usu&aacute;rio&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button id=&quot;close-card-manager-modal-button&quot; class=&quot;mt-6 bg-white/10 text-white font-bold py-2 px-6 rounded-lg hover:bg-white/20 w-full&quot;&gt;Fechar&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp;&lt;/div&gt;<br><br> &nbsp; &nbsp;&lt;div id=&quot;recharge-modal&quot; class=&quot;modal fixed inset-0 bg-black/50 backdrop-blur-sm items-center justify-center p-4 z-50&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=&quot;glass-card text-white rounded-2xl shadow-xl p-6 max-w-md w-full h-auto flex flex-col&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;h2 class=&quot;text-2xl font-bold mb-4 text-[var(--brand-orange)]&quot;&gt;Recarregar Saldo&lt;/h2&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=&quot;space-y-4&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=&quot;p-3 border border-white/10 rounded-lg&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;h3 class=&quot;font-semibold mb-2&quot;&gt;1. Buscar Usu&aacute;rio&lt;/h3&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;form id=&quot;search-user-for-recharge-form&quot; class=&quot;flex space-x-2&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;input type=&quot;email&quot; id=&quot;search-user-for-recharge-email&quot; placeholder=&quot;E-mail do usu&aacute;rio&quot; class=&quot;w-full px-3 py-2 bg-white/10 border-2 border-white/20 rounded-lg&quot; required&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button type=&quot;submit&quot; class=&quot;bg-gray-600 text-white font-bold p-3 rounded-lg&quot;&gt;Buscar&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/form&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div id=&quot;found-user-for-recharge-info&quot; class=&quot;mt-2 text-sm&quot;&gt;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div id=&quot;recharge-action-div&quot; class=&quot;hidden p-3 border border-white/10 rounded-lg&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;h3 class=&quot;font-semibold mb-2&quot;&gt;2. Adicionar Cr&eacute;dito&lt;/h3&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;form id=&quot;recharge-form&quot; class=&quot;flex space-x-2&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;input type=&quot;number&quot; id=&quot;recharge-amount&quot; placeholder=&quot;Valor (ex: 50.00)&quot; step=&quot;0.01&quot; class=&quot;w-full px-3 py-2 bg-white/10 border-2 border-white/20 rounded-lg&quot; required&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button type=&quot;submit&quot; class=&quot;bg-green-600 text-white font-bold p-3 rounded-lg&quot;&gt;Recarregar&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/form&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button id=&quot;close-recharge-modal-button&quot; class=&quot;mt-6 bg-white/10 text-white font-bold py-2 px-6 rounded-lg hover:bg-white/20 w-full&quot;&gt;Fechar&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp;&lt;/div&gt;<br><br> &nbsp; &nbsp;&lt;div id=&quot;code-generator-modal&quot; class=&quot;modal fixed inset-0 bg-black/50 backdrop-blur-sm items-center justify-center p-4 z-50&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=&quot;glass-card text-white rounded-2xl shadow-xl p-6 max-w-md w-full h-auto flex flex-col&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;h2 class=&quot;text-2xl font-bold mb-4 text-[var(--brand-teal)]&quot;&gt;Gerador de C&oacute;digo de Recarga&lt;/h2&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=&quot;space-y-4&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;form id=&quot;generate-code-form&quot; class=&quot;flex space-x-2&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;input type=&quot;number&quot; id=&quot;generate-code-value&quot; placeholder=&quot;Valor do c&oacute;digo (ex: 20.00)&quot; class=&quot;w-full px-3 py-2 bg-white/10 border-2 border-white/20 rounded-lg&quot; required&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button type=&quot;submit&quot; class=&quot;w-full text-white font-bold p-3 rounded-lg btn bg-[var(--brand-teal)]&quot;&gt;Gerar&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/form&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=&quot;p-3 border-t border-white/10&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;h3 class=&quot;font-semibold mb-2&quot;&gt;C&oacute;digo Gerado:&lt;/h3&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;p id=&quot;generated-code-display&quot; class=&quot;text-center text-2xl font-mono bg-black/20 p-3 rounded-lg break-all&quot;&gt;...&lt;/p&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;p class=&quot;text-xs text-center mt-2 text-gray-400&quot;&gt;Entregue este c&oacute;digo ao cliente.&lt;/p&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button id=&quot;close-code-generator-modal-button&quot; class=&quot;mt-6 bg-white/10 text-white font-bold py-2 px-6 rounded-lg hover:bg-white/20 w-full&quot;&gt;Fechar&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp;&lt;/div&gt;<br><br> &nbsp; &nbsp;&lt;script type=&quot;module&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;// Importar fun&ccedil;&otilde;es necess&aacute;rias dos SDKs do Firebase<br> &nbsp; &nbsp; &nbsp; &nbsp;import { initializeApp } from &quot;https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js&quot;;<br> &nbsp; &nbsp; &nbsp; &nbsp;import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged, setPersistence, browserLocalPersistence } from &quot;https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js&quot;;<br> &nbsp; &nbsp; &nbsp; &nbsp;import { getFirestore, doc, setDoc, getDoc, onSnapshot, collection, addDoc, updateDoc, increment, runTransaction, query, where, getDocs, deleteDoc, serverTimestamp, orderBy } from &quot;https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js&quot;;<br><br> &nbsp; &nbsp; &nbsp; &nbsp;// Configura&ccedil;&atilde;o do Firebase da sua aplica&ccedil;&atilde;o web - CORRIGIDO<br> &nbsp; &nbsp; &nbsp; &nbsp;const firebaseConfig = {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;apiKey: &quot;AIzaSyDs09Z8AUYgTyc_Wempriv8d9uz0fnjLCI&quot;,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;authDomain: &quot;caslessv2.firebaseapp.com&quot;,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;projectId: &quot;caslessv2&quot;,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;storageBucket: &quot;caslessv2.firebasestorage.app&quot;,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;messagingSenderId: &quot;1082219179837&quot;,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;appId: &quot;1:1082219179837:web:973e8ef71f7f5a73331f54&quot;<br> &nbsp; &nbsp; &nbsp; &nbsp;};<br><br> &nbsp; &nbsp; &nbsp; &nbsp;// Objeto principal da aplica&ccedil;&atilde;o<br> &nbsp; &nbsp; &nbsp; &nbsp;const App = {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;services: {},<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;state: {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;currentUser: null,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;userData: null,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;unsubscribeUser: null,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;unsubscribeProducts: null,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;nfcAbortController: null,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cart: [],<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cardManagerState: { cardId: null, foundUser: null },<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;rechargeState: { foundUser: null }<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Inicializa&ccedil;&atilde;o da aplica&ccedil;&atilde;o<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;init() {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;try {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const app = initializeApp(firebaseConfig);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.services.auth = getAuth(app);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.services.db = getFirestore(app);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.setupEventListeners();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.setupAuthListener();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} catch (error) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;console.error(&quot;Erro cr&iacute;tico de inicializa&ccedil;&atilde;o:&quot;, error);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.body.innerHTML = `&lt;div class=&quot;p-4 text-red-700 bg-red-100&quot;&gt;Erro cr&iacute;tico de inicializa&ccedil;&atilde;o: ${error.message}&lt;/div&gt;`;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Fun&ccedil;&otilde;es de navega&ccedil;&atilde;o e UI<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;navigateTo(screenId) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.querySelectorAll(&#39;.screen&#39;).forEach(s =&gt; s.classList.remove(&#39;active&#39;));<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const screen = document.getElementById(screenId);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (screen) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;screen.classList.add(&#39;active&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;showModal(modalId, content = {}) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const modal = document.getElementById(modalId);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (modalId === &#39;generic-modal&#39; &amp;&amp; content.html) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.getElementById(&#39;generic-modal-content&#39;).innerHTML = content.html;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (modal) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;modal.classList.add(&#39;active&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;closeModal(modalId) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (this.state.nfcAbortController) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.state.nfcAbortController.abort();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.state.nfcAbortController = null;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const modal = document.getElementById(modalId);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (modal) modal.classList.remove(&#39;active&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// L&oacute;gica de Autentica&ccedil;&atilde;o e Dados<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;setupAuthListener() {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.createAuthUI();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;setPersistence(this.services.auth, browserLocalPersistence);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;onAuthStateChanged(this.services.auth, async (user) =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (this.state.unsubscribeUser) this.state.unsubscribeUser();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (this.state.unsubscribeProducts) this.state.unsubscribeProducts();<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (user) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.state.currentUser = user;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.navigateTo(&#39;data-loading-screen&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;try {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const hasRole = await this.loadInitialData(user);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (hasRole) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.navigateTo(this.state.userData.role === &#39;vendor&#39; ? &#39;vendor-dashboard-screen&#39; : &#39;client-dashboard-screen&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} else {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.navigateTo(&#39;role-selection-screen&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} catch (error) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;console.error(&quot;Erro ao carregar dados:&quot;, error);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.showModal(&#39;generic-modal&#39;, { html: `&lt;h3&gt;Erro Cr&iacute;tico&lt;/h3&gt;&lt;p&gt;${error.message}&lt;/p&gt;&lt;button onclick=&quot;window.App.services.auth.signOut()&quot; class=&quot;w-full mt-4 bg-red-600 text-white p-2 rounded-lg&quot;&gt;Sair&lt;/button&gt;` });<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} else {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.state.currentUser = null;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.state.userData = null;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.navigateTo(&#39;auth-screen&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;async loadInitialData(user) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const userDocRef = doc(this.services.db, &quot;users&quot;, user.uid);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;let userDoc = await getDoc(userDocRef);<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (!userDoc.exists()) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const newUserDoc = {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;email: user.email,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;balance: 0,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;paymentCode: Math.floor(100000 + Math.random() * 900000).toString(),<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;role: null<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;};<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;await setDoc(userDocRef, newUserDoc);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;userDoc = await getDoc(userDocRef); // Recarregar o documento ap&oacute;s a cria&ccedil;&atilde;o<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.listenToVendorProducts(user.uid);<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return new Promise((resolve) =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.state.unsubscribeUser = onSnapshot(userDocRef, (snapshot) =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (snapshot.exists()) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.state.userData = { id: snapshot.id, ...snapshot.data() };<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.getElementById(&#39;client-balance-display&#39;).textContent = `R$ ${this.state.userData.balance.toFixed(2).replace(&#39;.&#39;, &#39;,&#39;)}`;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.getElementById(&#39;vendor-balance-display&#39;).textContent = `R$ ${this.state.userData.balance.toFixed(2).replace(&#39;.&#39;, &#39;,&#39;)}`;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;resolve(!!this.state.userData.role);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} else {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;resolve(false);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;setupEventListeners() {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const self = this;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Eventos de clique para bot&otilde;es<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.addEventListener(&#39;click&#39;, (e) =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const target = e.target.closest(&#39;button, a&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (!target) return;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const actions = {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;generic-modal-close-button&#39;: () =&gt; self.closeModal(&#39;generic-modal&#39;),<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;close-products-modal-button&#39;: () =&gt; self.closeModal(&#39;manage-products-modal&#39;),<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;close-card-manager-modal-button&#39;: () =&gt; self.closeModal(&#39;card-manager-modal&#39;),<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;close-recharge-modal-button&#39;: () =&gt; self.closeModal(&#39;recharge-modal&#39;),<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;close-history-modal-button&#39;: () =&gt; self.closeModal(&#39;history-modal&#39;),<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;close-code-generator-modal-button&#39;: () =&gt; self.closeModal(&#39;code-generator-modal&#39;),<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;qr-reader-close&#39;: () =&gt; self.stopQrScanner(),<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;client-logout-button&#39;: () =&gt; self.services.auth.signOut(),<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;vendor-logout-button&#39;: () =&gt; self.services.auth.signOut(),<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;select-role-client&#39;: () =&gt; self.setUserRole(&#39;client&#39;),<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;select-role-vendor&#39;: () =&gt; self.setUserRole(&#39;vendor&#39;),<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;client-back-to-mode-selection&#39;: () =&gt; self.navigateTo(&#39;role-selection-screen&#39;),<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;vendor-back-to-mode-selection&#39;: () =&gt; self.navigateTo(&#39;role-selection-screen&#39;),<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;show-my-code-button&#39;: () =&gt; self.showClientCodes(),<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;pay-nfc-button&#39;: () =&gt; self.clientPayWithNFC(),<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;show-history-button&#39;: () =&gt; self.showHistory(),<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;manage-products-button&#39;: () =&gt; self.showModal(&#39;manage-products-modal&#39;),<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;checkout-button&#39;: () =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const total = self.state.cart.reduce((sum, item) =&gt; sum + item.price, 0);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.getElementById(&#39;payment-total-display&#39;).textContent = `R$ ${total.toFixed(2).replace(&#39;.&#39;, &#39;,&#39;)}`;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.navigateTo(&#39;vendor-payment-screen&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;cancel-payment-button&#39;: () =&gt; self.navigateTo(&#39;vendor-dashboard-screen&#39;),<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;open-recharge-modal-button&#39;: () =&gt; self.openRechargeModal(),<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;open-card-manager-button&#39;: () =&gt; self.openCardManagerModal(),<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;open-code-generator-button&#39;: () =&gt; self.openCodeGeneratorModal(),<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;read-card-button&#39;: () =&gt; self.readCardForLinking(),<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;link-card-button&#39;: () =&gt; self.linkCardToUser(),<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;receive-via-nfc-button&#39;: () =&gt; self.vendorReceiveWithNFC(),<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;receive-via-qr-button&#39;: () =&gt; self.vendorReceiveWithQR(),<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;redeem-code-button&#39;: () =&gt; self.navigateTo(&#39;redeem-code-screen&#39;),<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;redeem-code-back-button&#39;: () =&gt; self.navigateTo(&#39;client-dashboard-screen&#39;),<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;import-qr-button&#39;: () =&gt; document.getElementById(&#39;qr-file-input&#39;).click(),<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;show-register&#39;: (evt) =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; evt.preventDefault();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; document.getElementById(&#39;login-view&#39;).style.display = &#39;none&#39;;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; document.getElementById(&#39;register-view&#39;).style.display = &#39;block&#39;;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;show-login&#39;: (evt) =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; evt.preventDefault();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; document.getElementById(&#39;register-view&#39;).style.display = &#39;none&#39;;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; document.getElementById(&#39;login-view&#39;).style.display = &#39;block&#39;;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;};<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (actions[target.id]) actions[target.id](e);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Eventos de submiss&atilde;o de formul&aacute;rios<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.addEventListener(&#39;submit&#39;, (e) =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;e.preventDefault();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const formId = e.target.id;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const actions = {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;login-form&#39;: () =&gt; self.handleLogin(e),<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;register-form&#39;: () =&gt; self.handleRegister(e),<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;add-product-form&#39;: () =&gt; self.addProduct(e),<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;search-user-for-recharge-form&#39;: () =&gt; self.searchUserForRecharge(e),<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;recharge-form&#39;: () =&gt; self.executeRecharge(e),<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;search-user-for-card-form&#39;: () =&gt; self.searchUserForCard(e),<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;receive-via-code-form&#39;: () =&gt; self.vendorReceiveWithCode(e),<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;generate-code-form&#39;: () =&gt; self.generateRechargeCode(e),<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;redeem-code-form&#39;: () =&gt; self.redeemRechargeCode(e),<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;};<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (actions[formId]) actions[formId]();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Evento para sele&ccedil;&atilde;o de arquivo QR<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.getElementById(&#39;qr-file-input&#39;).addEventListener(&#39;change&#39;, (e) =&gt; this.handleQRFileSelect(e));<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;createAuthUI() {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const authScreen = document.getElementById(&#39;auth-screen&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;authScreen.innerHTML = `<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=&quot;text-center mb-8&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;h1 class=&quot;text-4xl font-extrabold text-white&quot;&gt;Cashless&lt;span class=&quot;text-[var(--brand-orange)]&quot;&gt;Pay&lt;/span&gt;&lt;/h1&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;p class=&quot;text-gray-300 mt-2&quot;&gt;Sua carteira digital, reinventada.&lt;/p&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div id=&quot;login-view&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;h2 class=&quot;text-2xl font-semibold mb-4 text-center text-white&quot;&gt;Acessar Conta&lt;/h2&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;form id=&quot;login-form&quot; class=&quot;space-y-4&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;input type=&quot;email&quot; id=&quot;login-email&quot; placeholder=&quot;Seu e-mail&quot; class=&quot;w-full px-4 py-3 border-2 border-gray-600 bg-gray-700 text-white rounded-lg&quot; required&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;input type=&quot;password&quot; id=&quot;login-password&quot; placeholder=&quot;Sua senha&quot; class=&quot;w-full px-4 py-3 border-2 border-gray-600 bg-gray-700 text-white rounded-lg&quot; required&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button type=&quot;submit&quot; class=&quot;w-full font-bold py-3 rounded-lg btn btn-primary&quot;&gt;Entrar&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/form&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;p class=&quot;text-center mt-4 text-gray-300&quot;&gt;N&atilde;o tem uma conta? &lt;a href=&quot;#&quot; id=&quot;show-register&quot; class=&quot;text-[var(--brand-orange)] font-semibold&quot;&gt;Cadastre-se&lt;/a&gt;&lt;/p&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div id=&quot;register-view&quot; style=&quot;display: none;&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;h2 class=&quot;text-2xl font-semibold mb-4 text-center text-white&quot;&gt;Criar Conta&lt;/h2&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;form id=&quot;register-form&quot; class=&quot;space-y-4&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;input type=&quot;email&quot; id=&quot;register-email&quot; placeholder=&quot;Seu e-mail&quot; class=&quot;w-full px-4 py-3 border-2 border-gray-600 bg-gray-700 text-white rounded-lg&quot; required&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;input type=&quot;password&quot; id=&quot;register-password&quot; placeholder=&quot;Crie uma senha&quot; class=&quot;w-full px-4 py-3 border-2 border-gray-600 bg-gray-700 text-white rounded-lg&quot; required&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button type=&quot;submit&quot; class=&quot;w-full bg-green-600 text-white font-bold py-3 rounded-lg btn&quot;&gt;Criar Conta&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/form&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;p class=&quot;text-center mt-4 text-gray-300&quot;&gt;J&aacute; tem uma conta? &lt;a href=&quot;#&quot; id=&quot;show-login&quot; class=&quot;text-[var(--brand-orange)] font-semibold&quot;&gt;Fa&ccedil;a Login&lt;/a&gt;&lt;/p&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;`;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;async handleLogin(e) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;try {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;await signInWithEmailAndPassword(this.services.auth, e.target.elements[&#39;login-email&#39;].value, e.target.elements[&#39;login-password&#39;].value);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} catch (error) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.showModal(&#39;generic-modal&#39;, { html: `&lt;h3 class=&#39;font-bold text-red-600&#39;&gt;Erro de Login&lt;/h3&gt;&lt;p&gt;${error.message}&lt;/p&gt;` });<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;async handleRegister(e) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;try {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;await createUserWithEmailAndPassword(this.services.auth, e.target.elements[&#39;register-email&#39;].value, e.target.elements[&#39;register-password&#39;].value);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} catch (error) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.showModal(&#39;generic-modal&#39;, { html: `&lt;h3 class=&#39;font-bold text-red-600&#39;&gt;Erro de Cadastro&lt;/h3&gt;&lt;p&gt;${error.message}&lt;/p&gt;` });<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;async setUserRole(role) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const userDocRef = doc(this.services.db, &quot;users&quot;, this.state.currentUser.uid);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;await updateDoc(userDocRef, { role: role });<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.state.userData.role = role;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.navigateTo(role === &#39;vendor&#39; ? &#39;vendor-dashboard-screen&#39; : &#39;client-dashboard-screen&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;showClientCodes() {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (!this.state.userData) return;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const qrContent = JSON.stringify({ userId: this.state.userData.id });<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.showModal(&#39;generic-modal&#39;, {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;html: `<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;h3 class=&#39;font-bold text-lg mb-2 text-center&#39;&gt;Meu C&oacute;digo&lt;/h3&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;p class=&#39;text-sm text-gray-400 mb-4 text-center&#39;&gt;Apresente para o vendedor.&lt;/p&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div id=&quot;qrcode-display&quot; class=&quot;flex justify-center my-4&quot;&gt;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;p class=&quot;text-center text-gray-500&quot;&gt;Ou use o c&oacute;digo abaixo:&lt;/p&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;p class=&quot;text-3xl font-bold tracking-widest text-center text-[var(--brand-orange)] bg-black/20 p-3 rounded-lg&quot;&gt;${this.state.userData.paymentCode}&lt;/p&gt;`<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;new QRCode(document.getElementById(&quot;qrcode-display&quot;), { text: qrContent, width: 200, height: 200 });<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Fun&ccedil;&otilde;es do Vendedor<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;async addProduct(e) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const name = e.target.elements[&#39;product-name&#39;].value;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const price = parseFloat(e.target.elements[&#39;product-price&#39;].value);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (name &amp;&amp; !isNaN(price) &amp;&amp; price &gt; 0) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;await addDoc(collection(this.services.db, &quot;users&quot;, this.state.currentUser.uid, &quot;products&quot;), { name, price });<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;e.target.reset();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;listenToVendorProducts(uid) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const productsRef = collection(this.services.db, &quot;users&quot;, uid, &quot;products&quot;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const q = query(productsRef, orderBy(&quot;name&quot;));<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.state.unsubscribeProducts = onSnapshot(q, (snapshot) =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const productList = document.getElementById(&#39;vendor-product-list&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const managementList = document.getElementById(&#39;products-management-list&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;productList.innerHTML = &quot;&quot;;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;managementList.innerHTML = &quot;&quot;;<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (snapshot.empty) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;productList.innerHTML = &#39;&lt;p class=&quot;text-gray-500 col-span-full text-center&quot;&gt;Nenhum produto cadastrado.&lt;/p&gt;&#39;;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;snapshot.forEach(docSnap =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const product = { id: docSnap.id, ...docSnap.data() };<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Lista de produtos para venda<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const pEl = document.createElement(&#39;div&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pEl.className = &#39;p-3 rounded-2xl text-center cursor-pointer glass-card hover:bg-white/20 transition-all&#39;;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pEl.innerHTML = `&lt;h4 class=&quot;font-semibold text-white&quot;&gt;${product.name}&lt;/h4&gt;&lt;p class=&quot;text-sm text-green-400&quot;&gt;R$ ${product.price.toFixed(2)}&lt;/p&gt;`;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pEl.onclick = () =&gt; this.addToCart(product);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;productList.appendChild(pEl);<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Lista de produtos para gerenciamento<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const mEl = document.createElement(&#39;div&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;mEl.className = &#39;flex justify-between items-center p-2 border-b border-white/10&#39;;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;mEl.innerHTML = `&lt;span&gt;${product.name} (R$ ${product.price.toFixed(2)})&lt;/span&gt;&lt;button data-id=&quot;${product.id}&quot; class=&quot;text-red-500 hover:text-red-700 font-bold text-xl&quot;&gt;&times;&lt;/button&gt;`;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;mEl.querySelector(&#39;button&#39;).onclick = async () =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Usar um modal de confirma&ccedil;&atilde;o seria melhor que window.confirm<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (confirm(&#39;Tem certeza que deseja remover este produto?&#39;)) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;await deleteDoc(doc(this.services.db, &quot;users&quot;, this.state.currentUser.uid, &quot;products&quot;, product.id));<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;};<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;managementList.appendChild(mEl);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;addToCart(product) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.state.cart.push(product);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.renderCart();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;removeFromCart(index) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.state.cart.splice(index, 1);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.renderCart();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;renderCart() {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const cartItemsEl = document.getElementById(&#39;cart-items&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const cartTotalEl = document.getElementById(&#39;cart-total&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const checkoutBtn = document.getElementById(&#39;checkout-button&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cartItemsEl.innerHTML = &quot;&quot;;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;let total = 0;<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (this.state.cart.length === 0) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cartItemsEl.innerHTML = &#39;&lt;p class=&quot;text-gray-400 text-center mt-8&quot;&gt;Carrinho vazio.&lt;/p&gt;&#39;;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;checkoutBtn.disabled = true;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cartTotalEl.textContent = &#39;R$ 0,00&#39;;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.state.cart.forEach((item, index) =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;total += item.price;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const itemEl = document.createElement(&#39;div&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;itemEl.className = &#39;flex justify-between items-center bg-white/5 p-2 rounded-lg&#39;;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;itemEl.innerHTML = `<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;p class=&quot;text-white&quot;&gt;${item.name}&lt;/p&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;p class=&quot;text-xs text-gray-400&quot;&gt;R$ ${item.price.toFixed(2)}&lt;/p&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button data-index=&quot;${index}&quot; class=&quot;text-red-500 hover:text-red-700 font-semibold text-lg&quot;&gt;&times;&lt;/button&gt;`;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;itemEl.querySelector(&#39;button&#39;).onclick = () =&gt; this.removeFromCart(index);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cartItemsEl.appendChild(itemEl);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cartTotalEl.textContent = `R$ ${total.toFixed(2).replace(&#39;.&#39;, &#39;,&#39;)}`;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;checkoutBtn.disabled = false;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Fun&ccedil;&otilde;es de Recarga<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;openRechargeModal() {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.state.rechargeState = { foundUser: null };<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.updateRechargeUI();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.showModal(&#39;recharge-modal&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;async searchUserForRecharge(e) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const email = document.getElementById(&#39;search-user-for-recharge-email&#39;).value;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const q = query(collection(this.services.db, &quot;users&quot;), where(&quot;email&quot;, &quot;==&quot;, email));<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const snapshot = await getDocs(q);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (snapshot.empty) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.state.rechargeState.foundUser = null;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.showModal(&#39;generic-modal&#39;, { html: &#39;&lt;h3&gt;Usu&aacute;rio n&atilde;o encontrado&lt;/h3&gt;&#39; });<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} else {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const userDoc = snapshot.docs[0];<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.state.rechargeState.foundUser = { id: userDoc.id, ...userDoc.data() };<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.updateRechargeUI();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;async executeRecharge(e) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (!this.state.rechargeState.foundUser) return this.showModal(&#39;generic-modal&#39;, { html: &#39;&lt;h3&gt;Nenhum usu&aacute;rio selecionado&lt;/h3&gt;&#39; });<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const amountInput = document.getElementById(&#39;recharge-amount&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const amount = parseFloat(amountInput.value);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (isNaN(amount) || amount &lt;= 0) return this.showModal(&#39;generic-modal&#39;, { html: &#39;&lt;h3&gt;Valor de recarga inv&aacute;lido&lt;/h3&gt;&#39; });<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;try {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;await updateDoc(doc(this.services.db, &quot;users&quot;, this.state.rechargeState.foundUser.id), { balance: increment(amount) });<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.showModal(&#39;generic-modal&#39;, { html: `&lt;h3&gt;Sucesso!&lt;/h3&gt;&lt;p&gt;Recarga de R$ ${amount.toFixed(2)} realizada para ${this.state.rechargeState.foundUser.email}!&lt;/p&gt;` });<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;amountInput.value = &quot;&quot;;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.state.rechargeState.foundUser.balance += amount; // Atualiza o estado local<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.updateRechargeUI();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} catch (error) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.showModal(&#39;generic-modal&#39;, { html: `&lt;h3&gt;Erro na Recarga&lt;/h3&gt;&lt;p&gt;${error.message}&lt;/p&gt;` });<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;updateRechargeUI() {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const userInfoEl = document.getElementById(&#39;found-user-for-recharge-info&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const rechargeActionEl = document.getElementById(&#39;recharge-action-div&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (this.state.rechargeState.foundUser) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;userInfoEl.innerHTML = `Usu&aacute;rio: &lt;strong&gt;${this.state.rechargeState.foundUser.email}&lt;/strong&gt;&lt;br&gt;Saldo Atual: R$ ${this.state.rechargeState.foundUser.balance.toFixed(2)}`;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;rechargeActionEl.classList.remove(&#39;hidden&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} else {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;userInfoEl.innerHTML = &quot;&quot;;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;rechargeActionEl.classList.add(&#39;hidden&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Fun&ccedil;&otilde;es de Gerenciamento de Cart&atilde;o<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;openCardManagerModal() {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.state.cardManagerState = { cardId: null, foundUser: null };<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.updateCardManagerUI();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.showModal(&#39;card-manager-modal&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;async searchUserForCard(e) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const email = document.getElementById(&#39;search-user-for-card-email&#39;).value;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const q = query(collection(this.services.db, &quot;users&quot;), where(&quot;email&quot;, &quot;==&quot;, email));<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const snapshot = await getDocs(q);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (snapshot.empty) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.state.cardManagerState.foundUser = null;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.showModal(&#39;generic-modal&#39;, { html: &#39;&lt;h3&gt;Usu&aacute;rio n&atilde;o encontrado&lt;/h3&gt;&#39; });<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} else {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const userDoc = snapshot.docs[0];<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.state.cardManagerState.foundUser = { id: userDoc.id, ...userDoc.data() };<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.updateCardManagerUI();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;async readCardForLinking() {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (!(&quot;NDEFReader&quot; in window)) return this.handleNFCError(new DOMException(&quot;NFC n&atilde;o suportado.&quot;, &quot;NotSupportedError&quot;));<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;try {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const ndef = new NDEFReader();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;await ndef.scan();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.showModal(&#39;generic-modal&#39;, { html: `&lt;h3&gt;Aproxime o Cart&atilde;o&lt;/h3&gt;&lt;p&gt;Aproxime um cart&atilde;o ou tag NFC para ler seu ID.&lt;/p&gt;` });<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ndef.addEventListener(&quot;reading&quot;, ({ serialNumber }) =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (serialNumber) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// ndef.stop(); // A API foi depreciada, a leitura para automaticamente.<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.state.cardManagerState.cardId = serialNumber;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.closeModal(&#39;generic-modal&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.updateCardManagerUI();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} catch (error) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.handleNFCError(error);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;async linkCardToUser() {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (!this.state.cardManagerState.cardId || !this.state.cardManagerState.foundUser) return;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const cardRef = doc(this.services.db, &quot;nfc_cards&quot;, this.state.cardManagerState.cardId);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;try {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;await setDoc(cardRef, {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;userId: this.state.cardManagerState.foundUser.id,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;userEmail: this.state.cardManagerState.foundUser.email,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;registeredAt: serverTimestamp(),<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;registeredBy: this.state.currentUser.uid<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.showModal(&#39;generic-modal&#39;, { html: `&lt;h3&gt;Sucesso!&lt;/h3&gt;&lt;p&gt;Cart&atilde;o vinculado ao usu&aacute;rio ${this.state.cardManagerState.foundUser.email}.&lt;/p&gt;` });<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.closeModal(&#39;card-manager-modal&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} catch (error) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.showModal(&#39;generic-modal&#39;, { html: `&lt;h3&gt;Erro ao Vincular&lt;/h3&gt;&lt;p&gt;${error.message}&lt;/p&gt;` });<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;updateCardManagerUI() {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.getElementById(&#39;scanned-card-id&#39;).textContent = this.state.cardManagerState.cardId || &#39;Nenhum&#39;;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const userInfoEl = document.getElementById(&#39;found-user-for-card-info&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (this.state.cardManagerState.foundUser) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;userInfoEl.innerHTML = `Usu&aacute;rio: &lt;strong&gt;${this.state.cardManagerState.foundUser.email}&lt;/strong&gt;`;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} else {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;userInfoEl.innerHTML = &quot;&quot;;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.getElementById(&#39;link-card-button&#39;).disabled = !(this.state.cardManagerState.cardId &amp;&amp; this.state.cardManagerState.foundUser);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Fun&ccedil;&otilde;es de Gera&ccedil;&atilde;o e Resgate de C&oacute;digo<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;openCodeGeneratorModal() {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.getElementById(&#39;generated-code-display&#39;).textContent = &#39;...&#39;;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.showModal(&#39;code-generator-modal&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;async generateRechargeCode(e) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const value = parseFloat(e.target.elements[&#39;generate-code-value&#39;].value);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (isNaN(value) || value &lt;= 0) return this.showModal(&#39;generic-modal&#39;, { html: &#39;&lt;h3&gt;Valor inv&aacute;lido&lt;/h3&gt;&#39; });<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;try {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const codeRef = await addDoc(collection(this.services.db, &quot;recharge_codes&quot;), {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;value: value,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;createdAt: serverTimestamp(),<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;createdBy: this.state.currentUser.uid,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;used: false<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.getElementById(&#39;generated-code-display&#39;).textContent = codeRef.id;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;e.target.reset();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} catch (error) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.showModal(&#39;generic-modal&#39;, { html: `&lt;h3&gt;Erro ao Gerar C&oacute;digo&lt;/h3&gt;&lt;p&gt;${error.message}&lt;/p&gt;` });<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;async redeemRechargeCode(e) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const code = e.target.elements[&#39;recharge-code-input&#39;].value;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (!code) return;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const codeRef = doc(this.services.db, &quot;recharge_codes&quot;, code);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;try {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;await runTransaction(this.services.db, async (transaction) =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const codeDoc = await transaction.get(codeRef);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (!codeDoc.exists() || codeDoc.data().used) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;throw new Error(&quot;C&oacute;digo inv&aacute;lido ou j&aacute; utilizado.&quot;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const value = codeDoc.data().value;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const userRef = doc(this.services.db, &quot;users&quot;, this.state.currentUser.uid);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;transaction.update(userRef, { balance: increment(value) });<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;transaction.update(codeRef, { used: true, usedBy: this.state.currentUser.uid, usedAt: serverTimestamp() });<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.showModal(&#39;generic-modal&#39;, { html: `&lt;h3&gt;Sucesso!&lt;/h3&gt;&lt;p&gt;Recarga realizada com sucesso.&lt;/p&gt;` });<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.navigateTo(&#39;client-dashboard-screen&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} catch (error) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.showModal(&#39;generic-modal&#39;, { html: `&lt;h3&gt;Erro na Recarga&lt;/h3&gt;&lt;p&gt;${error.message}&lt;/p&gt;` });<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Fun&ccedil;&otilde;es de Pagamento (NFC, QR, etc.)<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;handleNFCError(error) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;let message = `&lt;h3 class=&#39;font-bold text-red-600&#39;&gt;Erro NFC&lt;/h3&gt;`;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (error.name === &#39;AbortError&#39;) { return; } // Opera&ccedil;&atilde;o cancelada pelo usu&aacute;rio<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (error.name === &#39;NotAllowedError&#39;) { message += &#39;&lt;p&gt;Permiss&atilde;o para usar NFC foi negada.&lt;/p&gt;&#39;; } <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;else if (error.name === &#39;NotSupportedError&#39;) { message += &#39;&lt;p&gt;NFC n&atilde;o &eacute; suportado neste dispositivo ou navegador.&lt;/p&gt;&#39;; } <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;else { message += `&lt;p&gt;Ocorreu um erro: ${error.message}&lt;/p&gt;`; }<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.showModal(&#39;generic-modal&#39;, { html: message });<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;async clientPayWithNFC() {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (!(&quot;NDEFReader&quot; in window)) return this.handleNFCError(new DOMException(&quot;NFC n&atilde;o suportado.&quot;, &quot;NotSupportedError&quot;));<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;try {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const ndef = new NDEFReader();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;await ndef.write({ records: [{ recordType: &quot;text&quot;, data: JSON.stringify({ userId: this.state.currentUser.uid }) }] });<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.showModal(&#39;generic-modal&#39;, { html: `&lt;h3&gt;Pagamento Enviado!&lt;/h3&gt;&lt;p&gt;Aguarde a confirma&ccedil;&atilde;o do vendedor.&lt;/p&gt;` });<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} catch (error) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.handleNFCError(error);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;async vendorReceiveWithNFC() {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (!(&quot;NDEFReader&quot; in window)) return this.handleNFCError(new DOMException(&quot;NFC n&atilde;o suportado.&quot;, &quot;NotSupportedError&quot;));<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;try {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const ndef = new NDEFReader();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.state.nfcAbortController = new AbortController();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;await ndef.scan({ signal: this.state.nfcAbortController.signal });<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.showModal(&#39;generic-modal&#39;, { html: &#39;&lt;h3&gt;Aguardando Aproxima&ccedil;&atilde;o&lt;/h3&gt;&lt;p&gt;Aproxime o cart&atilde;o ou celular do cliente.&lt;/p&gt;&#39; });<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ndef.addEventListener(&quot;reading&quot;, async ({ serialNumber, message }) =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (this.state.nfcAbortController.signal.aborted) return;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.state.nfcAbortController.abort(); // Para a leitura ap&oacute;s o primeiro sucesso<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.closeModal(&#39;generic-modal&#39;);<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (serialNumber) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const cardDoc = await getDoc(doc(this.services.db, &quot;nfc_cards&quot;, serialNumber));<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (cardDoc.exists()) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return this.handleTransaction(cardDoc.data().userId);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} else {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return this.showModal(&#39;generic-modal&#39;, { html: &#39;&lt;h3&gt;Cart&atilde;o n&atilde;o Cadastrado&lt;/h3&gt;&#39; });<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;for (const record of message.records) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;try {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const data = JSON.parse(new TextDecoder().decode(record.data));<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (data.userId) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return this.handleTransaction(data.userId);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} catch (e) { continue; }<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.showModal(&#39;generic-modal&#39;, { html: &#39;&lt;h3&gt;Nenhum dado v&aacute;lido encontrado no dispositivo NFC.&lt;/h3&gt;&#39; });<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} catch (error) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.handleNFCError(error);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;vendorReceiveWithQR() {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const html5QrCode = new Html5Qrcode(&quot;qr-reader&quot;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;window.qrScanner = html5QrCode; // Armazena a inst&acirc;ncia para poder par&aacute;-la<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.showModal(&#39;qr-reader-modal&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;html5QrCode.start(<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ facingMode: &quot;environment&quot; },<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ fps: 10, qrbox: { width: 250, height: 250 } },<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(decodedText) =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.stopQrScanner();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;try {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const customerInfo = JSON.parse(decodedText);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (!customerInfo.userId) throw new Error(&quot;QR Code inv&aacute;lido.&quot;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.handleTransaction(customerInfo.userId);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} catch (e) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.showModal(&#39;generic-modal&#39;, { html: `&lt;h3 class=&#39;font-bold text-red-600&#39;&gt;QR Code Inv&aacute;lido&lt;/h3&gt;&lt;p&gt;${e.message}&lt;/p&gt;` });<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(error) =&gt; { /* Ignorar erros de &quot;QR Code n&atilde;o encontrado&quot; */ }<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;).catch(err =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.showModal(&#39;generic-modal&#39;, { html: `&lt;h3 class=&#39;font-bold text-red-600&#39;&gt;Erro na C&acirc;mera&lt;/h3&gt;&lt;p&gt;${err.message}&lt;/p&gt;` });<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;stopQrScanner() {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (window.qrScanner &amp;&amp; window.qrScanner.isScanning) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;window.qrScanner.stop().catch(err =&gt; console.error(&quot;Erro ao parar o scanner:&quot;, err));<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.closeModal(&#39;qr-reader-modal&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;async vendorReceiveWithCode(e) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const code = e.target.elements[&#39;receive-code-input&#39;].value;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const q = query(collection(this.services.db, &quot;users&quot;), where(&quot;paymentCode&quot;, &quot;==&quot;, code));<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const snapshot = await getDocs(q);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (snapshot.empty) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return this.showModal(&#39;generic-modal&#39;, { html: `&lt;h3 class=&#39;font-bold text-red-600&#39;&gt;C&oacute;digo n&atilde;o encontrado&lt;/h3&gt;` });<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.handleTransaction(snapshot.docs[0].id);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;handleQRFileSelect(e) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const file = e.target.files[0];<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (!file) return;<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Html5Qrcode.scanFile(file, true)<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.then(decodedText =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const customerInfo = JSON.parse(decodedText);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (!customerInfo.userId) throw new Error(&quot;QR Code inv&aacute;lido.&quot;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.handleTransaction(customerInfo.userId);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;})<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.catch(err =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.showModal(&#39;generic-modal&#39;, { html: `&lt;h3 class=&#39;font-bold text-red-600&#39;&gt;QR Code Inv&aacute;lido&lt;/h3&gt;&lt;p&gt;N&atilde;o foi poss&iacute;vel ler o QR Code do arquivo. ${err.message}&lt;/p&gt;` });<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;e.target.value = &#39;&#39;; // Limpa o input para permitir a sele&ccedil;&atilde;o do mesmo arquivo novamente<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;async handleTransaction(customerId) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const total = this.state.cart.reduce((sum, item) =&gt; sum + item.price, 0);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (total &lt;= 0) return;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (this.state.currentUser.uid === customerId) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return this.showModal(&#39;generic-modal&#39;, { html: `&lt;h3 class=&#39;font-bold text-red-600&#39;&gt;A&ccedil;&atilde;o Inv&aacute;lida&lt;/h3&gt;&lt;p&gt;Voc&ecirc; n&atilde;o pode vender para si mesmo.&lt;/p&gt;` });<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;try {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;await runTransaction(this.services.db, async (transaction) =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const customerRef = doc(this.services.db, &quot;users&quot;, customerId);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const vendorRef = doc(this.services.db, &quot;users&quot;, this.state.currentUser.uid);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const customerDoc = await transaction.get(customerRef);<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (!customerDoc.exists()) throw new Error(&quot;Cliente n&atilde;o encontrado.&quot;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (customerDoc.data().balance &lt; total) throw new Error(&quot;Saldo do cliente &eacute; insuficiente.&quot;);<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Atualiza os saldos<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;transaction.update(customerRef, { balance: increment(-total) });<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;transaction.update(vendorRef, { balance: increment(total) });<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Cria um registro da transa&ccedil;&atilde;o<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const transactionRef = doc(collection(this.services.db, &quot;transactions&quot;));<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;transaction.set(transactionRef, {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;vendorId: this.state.currentUser.uid,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;customerId: customerId,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;items: this.state.cart,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;total: total,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;createdAt: serverTimestamp()<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.showModal(&#39;generic-modal&#39;, { html: `&lt;h3 class=&#39;font-bold text-green-600 text-xl&#39;&gt;Pagamento Aprovado!&lt;/h3&gt;&lt;p class=&#39;mt-2&#39;&gt;Venda de &lt;strong&gt;R$ ${total.toFixed(2)}&lt;/strong&gt; conclu&iacute;da.&lt;/p&gt;` });<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.state.cart = [];<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.renderCart();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.navigateTo(&#39;vendor-dashboard-screen&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} catch (error) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.showModal(&#39;generic-modal&#39;, { html: `&lt;h3 class=&#39;font-bold text-red-600&#39;&gt;Pagamento Recusado&lt;/h3&gt;&lt;p&gt;${error.toString()}&lt;/p&gt;` });<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;async showHistory() {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const historyListEl = document.getElementById(&#39;history-list&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;historyListEl.innerHTML = &#39;&lt;p class=&quot;text-center&quot;&gt;Carregando hist&oacute;rico...&lt;/p&gt;&#39;;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.showModal(&#39;history-modal&#39;);<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const q = query(collection(this.services.db, &quot;transactions&quot;), where(&quot;customerId&quot;, &quot;==&quot;, this.state.currentUser.uid), orderBy(&quot;createdAt&quot;, &quot;desc&quot;));<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const snapshot = await getDocs(q);<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (snapshot.empty) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;historyListEl.innerHTML = &#39;&lt;p class=&quot;text-center text-gray-500&quot;&gt;Nenhuma compra encontrada.&lt;/p&gt;&#39;;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;historyListEl.innerHTML = &quot;&quot;;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;snapshot.forEach(doc =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const tx = doc.data();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const date = tx.createdAt ? tx.createdAt.toDate().toLocaleString(&#39;pt-BR&#39;) : &#39;Data pendente&#39;;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;let itemsHtml = tx.items.map(item =&gt; `&lt;li&gt;${item.name} - R$ ${item.price.toFixed(2)}&lt;/li&gt;`).join(&quot;&quot;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const txEl = document.createElement(&#39;div&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;txEl.className = &#39;p-3 border-b border-white/10&#39;;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;txEl.innerHTML = `<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=&quot;flex justify-between items-center&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;span class=&quot;font-bold&quot;&gt;R$ ${tx.total.toFixed(2)}&lt;/span&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;span class=&quot;text-sm text-gray-400&quot;&gt;${date}&lt;/span&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;ul class=&quot;text-sm text-gray-300 list-disc list-inside mt-1&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;${itemsHtml}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/ul&gt;`;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;historyListEl.appendChild(txEl);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp;};<br><br> &nbsp; &nbsp; &nbsp; &nbsp;// Expor o objeto App globalmente para ser acess&iacute;vel no HTML (ex: onclick) e iniciar<br> &nbsp; &nbsp; &nbsp; &nbsp;window.App = App;<br> &nbsp; &nbsp; &nbsp; &nbsp;App.init();<br> &nbsp; &nbsp;&lt;/script&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;<br></span></p></body></html>